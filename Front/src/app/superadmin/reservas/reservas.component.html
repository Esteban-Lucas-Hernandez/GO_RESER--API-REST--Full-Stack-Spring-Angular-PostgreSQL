<div class="reservas-container">
  <h2>Gestión de Reservas</h2>

  <!-- Filtro de hoteles -->
  <div class="filtro-container">
    <label for="hotel-select">Seleccionar Hotel:</label>
    <select
      id="hotel-select"
      [value]="selectedHotelId || ''"
      (change)="onHotelChange($event)"
      [disabled]="loading"
      class="form-control"
    >
      <option value="">Todos los hoteles</option>
      <option *ngFor="let hotel of hoteles" [value]="hotel.id">
        {{ hotel.nombre }}
      </option>
    </select>

    <button
      (click)="resetFilter()"
      class="btn btn-secondary"
      [disabled]="loading"
      *ngIf="selectedHotelId"
    >
      Mostrar Todas las Reservas
    </button>
  </div>

  <!-- Indicador de carga -->
  <div *ngIf="loading" class="loading">
    <p>Cargando...</p>
  </div>

  <div *ngIf="error" class="error">
    <p>{{ error }}</p>
  </div>

  <!-- Tabla de reservas -->
  <div class="tabla-container" *ngIf="!loading && !error">
    <table class="tabla-reservas">
      <thead>
        <tr>
          <th>Email Usuario</th>
          <th>Número Habitación</th>
          <th>Fecha Inicio</th>
          <th>Fecha Fin</th>
          <th>Total</th>
          <th>Estado</th>
          <th>Método de Pago</th>
          <th>Fecha Reserva</th>
          <th class="actions-cell">Acciones</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let reserva of reservas">
          <td>{{ reserva.emailUsuario }}</td>
          <td>{{ reserva.numeroHabitacion }}</td>
          <td>{{ reserva.fechaInicio | date : 'dd/MM/yyyy' }}</td>
          <td>{{ reserva.fechaFin | date : 'dd/MM/yyyy' }}</td>
          <td>${{ reserva.total }}</td>
          <td>{{ reserva.estado }}</td>
          <td>{{ reserva.metodoPago }}</td>
          <td>{{ reserva.fechaReserva | date : 'dd/MM/yyyy HH:mm' }}</td>
          <td class="actions-cell">
            <button class="btn-pdf" (click)="descargarPdf(reserva.idReserva)" title="Descargar PDF">
              <svg
                xmlns="http://www.w3.org/2000/svg"
                width="16"
                height="16"
                fill="white"
                class="bi bi-file-pdf"
                viewBox="0 0 16 16"
              >
                <path
                  d="M4 0a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h8a2 2 0 0 0 2-2V2a2 2 0 0 0-2-2H4zm0 1h8a1 1 0 0 1 1 1v12a1 1 0 0 1-1 1H4a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1z"
                />
                <path
                  d="M4.5 11.5A.5.5 0 0 1 5 11h2a.5.5 0 0 1 0 1H5v1.5a.5.5 0 0 1-1 0V10.5a.5.5 0 0 1 .5-.5zm3.5-2a.5.5 0 0 1 .5.5v3a.5.5 0 0 1-1 0V10H5.5a.5.5 0 0 1 0-1H8zm2.5-1a.5.5 0 0 1 .5.5v4a.5.5 0 0 1-1 0V9.5a.5.5 0 0 1 .5-.5zm2-1a.5.5 0 0 1 .5.5v5a.5.5 0 0 1-1 0V8.5a.5.5 0 0 1 .5-.5z"
                />
              </svg>
            </button>
          </td>
        </tr>
        <tr *ngIf="!loading && reservas.length === 0">
          <td colspan="9" class="no-data">No se encontraron reservas</td>
        </tr>
      </tbody>
    </table>
  </div>
</div>
